<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SeguroTech - Cotiza tu Seguro Personalizado</title>
    <link rel="icon" type="image/png" href="segurotech-logo.png">
    <link rel="shortcut icon" type="image/png" href="segurotech-logo.png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-color: #2563eb;
            --secondary-color: #10b981;
            --accent-color: #f59e0b;
            --dark-bg: #111827;
            --light-bg: #f9fafb;
            --text-dark: #1f2937;
            --text-light: #6b7280;
            --error-color: #ef4444;
            --success-color: #10b981;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            line-height: 1.6;
            color: var(--text-dark);
            background: var(--light-bg);
            overflow-x: hidden;
        }

        /* Navigation */
        nav {
            position: fixed;
            top: 0;
            width: 100%;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            z-index: 1000;
            box-shadow: 0 2px 20px rgba(0, 0, 0, 0.1);
        }

        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            text-decoration: none;
            cursor: pointer;
        }
        
        .logo img {
            height: 40px;
            width: auto;
            margin-right: 10px;
        }
        
        .logo-text {
            font-size: 1.5rem;
            font-weight: bold;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        /* Progress Bar */
        .progress-container {
            position: fixed;
            top: 60px;
            left: 0;
            right: 0;
            background: white;
            padding: 1rem;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            z-index: 999;
        }

        .progress-bar {
            max-width: 600px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            position: relative;
        }

        .progress-bar::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 2px;
            background: #e5e7eb;
            transform: translateY(-50%);
            z-index: -1;
        }

        .progress-step {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: white;
            border: 2px solid #e5e7eb;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            transition: all 0.3s;
            cursor: pointer;
        }

        .progress-step.active {
            background: var(--primary-color);
            border-color: var(--primary-color);
            color: white;
            transform: scale(1.1);
        }

        .progress-step.completed {
            background: var(--success-color);
            border-color: var(--success-color);
            color: white;
        }

        /* Main Content */
        .main-container {
            max-width: 1200px;
            margin: 140px auto 2rem;
            padding: 0 2rem;
            display: grid;
            grid-template-columns: 1fr 350px;
            gap: 2rem;
            min-height: calc(100vh - 160px);
        }

        /* Form Sections */
        .form-section {
            background: white;
            border-radius: 20px;
            padding: 2rem;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            display: none;
            animation: fadeIn 0.5s ease-out;
        }

        .form-section.active {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .section-header {
            margin-bottom: 2rem;
        }

        .section-header h2 {
            font-size: 2rem;
            margin-bottom: 0.5rem;
            color: var(--text-dark);
        }

        .section-header p {
            color: var(--text-light);
        }

        /* Insurance Type Selection */
        .insurance-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .insurance-option {
            padding: 1.5rem;
            border: 2px solid #e5e7eb;
            border-radius: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }

        .insurance-option:hover {
            border-color: var(--primary-color);
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(37, 99, 235, 0.1);
        }

        .insurance-option.selected {
            border-color: var(--primary-color);
            background: linear-gradient(135deg, rgba(37, 99, 235, 0.05), rgba(16, 185, 129, 0.05));
        }

        .insurance-option .icon {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
            color: var(--primary-color);
        }

        .insurance-option h3 {
            font-size: 1rem;
            color: var(--text-dark);
        }

        /* Form Inputs */
        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: var(--text-dark);
        }

        .form-group input,
        .form-group select {
            width: 100%;
            padding: 0.75rem 1rem;
            border: 2px solid #e5e7eb;
            border-radius: 10px;
            font-size: 1rem;
            transition: border-color 0.3s;
        }

        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: var(--primary-color);
        }

        /* Slider Inputs */
        .slider-container {
            margin-bottom: 2rem;
        }

        .slider-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .slider-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--primary-color);
        }

        .custom-slider {
            width: 100%;
            height: 8px;
            background: #e5e7eb;
            border-radius: 5px;
            outline: none;
            -webkit-appearance: none;
            position: relative;
            cursor: pointer;
        }

        .custom-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 24px;
            height: 24px;
            background: var(--primary-color);
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 2px 10px rgba(37, 99, 235, 0.3);
            transition: transform 0.2s;
        }

        .custom-slider::-webkit-slider-thumb:hover {
            transform: scale(1.2);
        }

        .custom-slider::-moz-range-thumb {
            width: 24px;
            height: 24px;
            background: var(--primary-color);
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 2px 10px rgba(37, 99, 235, 0.3);
            transition: transform 0.2s;
        }

        .slider-labels {
            display: flex;
            justify-content: space-between;
            margin-top: 0.5rem;
            font-size: 0.875rem;
            color: var(--text-light);
        }

        /* Coverage Visualization */
        .coverage-chart {
            background: var(--light-bg);
            border-radius: 15px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .coverage-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid #e5e7eb;
        }

        .coverage-item:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }

        .coverage-item .label {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .coverage-item .label i {
            color: var(--success-color);
        }

        .coverage-item .value {
            font-weight: bold;
            color: var(--primary-color);
        }

        /* Summary Sidebar */
        .summary-sidebar {
            position: sticky;
            top: 140px;
            height: fit-content;
        }

        .summary-card {
            background: white;
            border-radius: 20px;
            padding: 2rem;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        .summary-header {
            text-align: center;
            margin-bottom: 2rem;
            padding-bottom: 1.5rem;
            border-bottom: 2px solid var(--light-bg);
        }

        .summary-header h3 {
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
        }

        .price-display {
            font-size: 3rem;
            font-weight: bold;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .price-period {
            font-size: 1rem;
            color: var(--text-light);
        }

        .summary-details {
            margin-bottom: 2rem;
        }

        .detail-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.75rem;
            font-size: 0.875rem;
        }

        .detail-item .label {
            color: var(--text-light);
        }

        .detail-item .value {
            font-weight: 600;
            color: var(--text-dark);
        }

        /* Buttons */
        .button-group {
            display: flex;
            gap: 1rem;
            margin-top: 2rem;
        }

        .btn {
            padding: 0.75rem 1.5rem;
            border-radius: 50px;
            font-weight: 600;
            text-decoration: none;
            border: none;
            cursor: pointer;
            transition: all 0.3s;
            flex: 1;
            text-align: center;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(37, 99, 235, 0.3);
        }

        .btn-secondary {
            background: white;
            color: var(--primary-color);
            border: 2px solid var(--primary-color);
        }

        .btn-secondary:hover {
            background: var(--primary-color);
            color: white;
        }

        .btn-success {
            background: var(--success-color);
            color: white;
            width: 100%;
        }

        .btn-success:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(16, 185, 129, 0.3);
        }

        /* Features List */
        .features-list {
            margin-top: 1.5rem;
            padding-top: 1.5rem;
            border-top: 1px solid #e5e7eb;
        }

        .feature-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 0.5rem;
            font-size: 0.875rem;
            color: var(--text-light);
        }

        .feature-item .check {
            color: var(--success-color);
            font-weight: bold;
        }

        /* Loading Animation */
        .loading {
            display: none;
            text-align: center;
            padding: 2rem;
        }

        .loading.active {
            display: block;
        }

        .spinner {
            display: inline-block;
            width: 40px;
            height: 40px;
            border: 4px solid #e5e7eb;
            border-top-color: var(--primary-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        /* Success Message */
        .success-message {
            display: none;
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.1), rgba(37, 99, 235, 0.1));
            border: 2px solid var(--success-color);
            border-radius: 15px;
            padding: 2rem;
            text-align: center;
            margin-bottom: 2rem;
        }

        .success-message.active {
            display: block;
            animation: fadeIn 0.5s ease-out;
        }

        .success-message h3 {
            color: var(--success-color);
            margin-bottom: 0.5rem;
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            .main-container {
                grid-template-columns: 1fr;
                margin-top: 120px;
            }

            .summary-sidebar {
                position: fixed;
                bottom: 0;
                left: 0;
                right: 0;
                top: auto;
                z-index: 998;
            }

            .summary-card {
                border-radius: 20px 20px 0 0;
                box-shadow: 0 -10px 30px rgba(0, 0, 0, 0.1);
            }

            .price-display {
                font-size: 2rem;
            }

            .insurance-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .progress-container {
                padding: 0.5rem;
            }

            .progress-step {
                width: 30px;
                height: 30px;
                font-size: 0.875rem;
            }
        }

        /* Tooltips */
        .tooltip {
            position: relative;
            display: inline-block;
            cursor: help;
        }

        .tooltip .tooltiptext {
            visibility: hidden;
            width: 200px;
            background-color: var(--dark-bg);
            color: white;
            text-align: center;
            border-radius: 10px;
            padding: 0.5rem;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            margin-left: -100px;
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 0.875rem;
        }

        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }

        /* Animations */
        .pulse {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.05);
            }
            100% {
                transform: scale(1);
            }
        }

        /* Group Member Input */
        .group-member {
            display: flex;
            gap: 0.5rem;
            align-items: center;
            margin-bottom: 0.5rem;
        }

        .group-member input {
            flex: 1;
        }

        .group-member button {
            background: var(--error-color);
            color: white;
            border: none;
            padding: 0.5rem 0.75rem;
            border-radius: 8px;
            cursor: pointer;
            transition: background 0.3s;
        }

        .group-member button:hover {
            background: #dc2626;
        }

        .add-member-btn {
            background: var(--secondary-color);
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 8px;
            cursor: pointer;
            transition: background 0.3s;
            margin-top: 0.5rem;
        }

        .add-member-btn:hover {
            background: #059669;
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav>
        <div class="nav-container">
            <a href="index.html" class="logo">
                <img src="segurotech-logo.png" alt="SeguroTech Logo">
                <span class="logo-text">SeguroTech</span>
            </a>
            <div style="display: flex; align-items: center; gap: 1rem;">
                <span style="color: var(--text-light);">¿Necesitas ayuda?</span>
                <button class="btn btn-secondary" style="padding: 0.5rem 1rem;">Chat en vivo</button>
            </div>
        </div>
    </nav>

    <!-- Progress Bar -->
    <div class="progress-container">
        <div class="progress-bar">
            <div class="progress-step active" data-step="1">1</div>
            <div class="progress-step" data-step="2">2</div>
            <div class="progress-step" data-step="3">3</div>
            <div class="progress-step" data-step="4">4</div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="main-container">
        <!-- Form Section -->
        <div class="form-content">
            <!-- Step 1: Insurance Type -->
            <div class="form-section active" id="step1">
                <div class="section-header">
                    <h2>¿Qué quieres proteger?</h2>
                    <p>Selecciona el tipo de seguro que necesitas</p>
                </div>
                
                <div class="insurance-grid">
                    <div class="insurance-option" data-type="agricola">
                        <div class="icon"><i class="fas fa-seedling"></i></div>
                        <h3>Agrícola</h3>
                    </div>
                    <div class="insurance-option" data-type="vehiculo">
                        <div class="icon"><i class="fas fa-car"></i></div>
                        <h3>Vehículo</h3>
                    </div>
                    <div class="insurance-option" data-type="vida">
                        <div class="icon"><i class="fas fa-heart"></i></div>
                        <h3>Vida</h3>
                    </div>
                    <div class="insurance-option" data-type="salud">
                        <div class="icon"><i class="fas fa-hospital"></i></div>
                        <h3>Salud</h3>
                    </div>
                    <div class="insurance-option" data-type="dispositivo">
                        <div class="icon"><i class="fas fa-mobile-alt"></i></div>
                        <h3>Dispositivo</h3>
                    </div>
                    <div class="insurance-option" data-type="p2p">
                        <div class="icon"><i class="fas fa-users"></i></div>
                        <h3>P2P Comunitario</h3>
                    </div>
                    <div class="insurance-option" data-type="remesas">
                        <div class="icon"><i class="fas fa-money-bill-wave"></i></div>
                        <h3>Remesas</h3>
                    </div>
                    <div class="insurance-option" data-type="emprendedor">
                        <div class="icon"><i class="fas fa-briefcase"></i></div>
                        <h3>Emprendedor</h3>
                    </div>
                </div>

                <div class="button-group">
                    <button class="btn btn-primary" onclick="nextStep()" disabled id="step1-next">Continuar</button>
                </div>
            </div>

            <!-- Step 2: Basic Information -->
            <div class="form-section" id="step2">
                <div class="section-header">
                    <h2>Cuéntanos sobre ti</h2>
                    <p>Necesitamos algunos datos básicos</p>
                </div>

                <form id="basic-info-form">
                    <div class="form-group">
                        <label for="name">Nombre completo</label>
                        <input type="text" id="name" required>
                    </div>

                    <div class="form-group">
                        <label for="email">Correo electrónico</label>
                        <input type="email" id="email" required>
                    </div>

                    <div class="form-group">
                        <label for="phone">WhatsApp</label>
                        <input type="tel" id="phone" placeholder="+54 11 1234-5678" required>
                    </div>

                    <div class="form-group">
                        <label for="location">Provincia/Estado</label>
                        <select id="location" required>
                            <option value="">Selecciona tu ubicación</option>
                            <optgroup label="Argentina">
                                <option value="buenos-aires">Buenos Aires</option>
                                <option value="caba">Ciudad Autónoma de Buenos Aires</option>
                                <option value="catamarca">Catamarca</option>
                                <option value="chaco">Chaco</option>
                                <option value="chubut">Chubut</option>
                                <option value="cordoba">Córdoba</option>
                                <option value="corrientes">Corrientes</option>
                                <option value="entre-rios">Entre Ríos</option>
                                <option value="formosa">Formosa</option>
                                <option value="jujuy">Jujuy</option>
                                <option value="la-pampa">La Pampa</option>
                                <option value="la-rioja">La Rioja</option>
                                <option value="mendoza">Mendoza</option>
                                <option value="misiones">Misiones</option>
                                <option value="neuquen">Neuquén</option>
                                <option value="rio-negro">Río Negro</option>
                                <option value="salta">Salta</option>
                                <option value="san-juan">San Juan</option>
                                <option value="san-luis">San Luis</option>
                                <option value="santa-cruz">Santa Cruz</option>
                                <option value="santa-fe">Santa Fe</option>
                                <option value="santiago-del-estero">Santiago del Estero</option>
                                <option value="tierra-del-fuego">Tierra del Fuego</option>
                                <option value="tucuman">Tucumán</option>
                            </optgroup>
                            <optgroup label="México">
                                <option value="cdmx">Ciudad de México</option>
                                <option value="jalisco">Jalisco</option>
                                <option value="nuevo-leon">Nuevo León</option>
                                <option value="puebla">Puebla</option>
                            </optgroup>
                            <optgroup label="Colombia">
                                <option value="bogota">Bogotá</option>
                                <option value="antioquia">Antioquia</option>
                                <option value="valle-del-cauca">Valle del Cauca</option>
                            </optgroup>
                        </select>
                    </div>

                    <div class="button-group">
                        <button type="button" class="btn btn-secondary" onclick="previousStep()">Atrás</button>
                        <button type="button" class="btn btn-primary" onclick="nextStep()">Continuar</button>
                    </div>
                </form>
            </div>

            <!-- Step 3: Coverage Customization -->
            <div class="form-section" id="step3">
                <div class="section-header">
                    <h2>Personaliza tu cobertura</h2>
                    <p>Ajusta los parámetros según tus necesidades</p>
                </div>

                <!-- Agricultural Insurance Sliders -->
                <div id="agricola-params" class="insurance-params" style="display: none;">
                    <div class="slider-container">
                        <div class="slider-header">
                            <label>Umbral de lluvia (mm)</label>
                            <span class="slider-value" id="rainfall-value">250mm</span>
                        </div>
                        <input type="range" class="custom-slider" id="rainfall-slider" min="100" max="500" value="250" step="10">
                        <div class="slider-labels">
                            <span>Mayor riesgo</span>
                            <span>Menor riesgo</span>
                        </div>
                    </div>

                    <div class="slider-container">
                        <div class="slider-header">
                            <label>Cobertura por hectárea</label>
                            <span class="slider-value" id="coverage-value">$5,000</span>
                        </div>
                        <input type="range" class="custom-slider" id="coverage-slider" min="1000" max="20000" value="5000" step="1000">
                        <div class="slider-labels">
                            <span>$1,000</span>
                            <span>$20,000</span>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Número de hectáreas</label>
                        <input type="number" id="hectares" min="1" value="10" required oninput="calculatePrice()" onchange="calculatePrice()">
                    </div>
                </div>

                <!-- Vehicle Insurance Sliders -->
                <div id="vehiculo-params" class="insurance-params" style="display: none;">
                    <div class="slider-container">
                        <div class="slider-header">
                            <label>Kilómetros promedio por mes</label>
                            <span class="slider-value" id="km-value">1,000 km</span>
                        </div>
                        <input type="range" class="custom-slider" id="km-slider" min="100" max="5000" value="1000" step="100">
                        <div class="slider-labels">
                            <span>100 km</span>
                            <span>5,000 km</span>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Tipo de uso</label>
                        <select id="vehicle-use">
                            <option value="personal">Personal</option>
                            <option value="uber">Uber/Didi/Cabify</option>
                            <option value="delivery">Delivery</option>
                            <option value="comercial">Comercial</option>
                        </select>
                    </div>
                </div>

                <!-- Life Insurance Sliders -->
                <div id="vida-params" class="insurance-params" style="display: none;">
                    <div class="slider-container">
                        <div class="slider-header">
                            <label>Suma asegurada</label>
                            <span class="slider-value" id="life-coverage-value">$50,000</span>
                        </div>
                        <input type="range" class="custom-slider" id="life-coverage-slider" min="10000" max="500000" value="50000" step="10000">
                        <div class="slider-labels">
                            <span>$10,000</span>
                            <span>$500,000</span>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Edad</label>
                        <input type="number" id="life-age" min="18" max="70" value="35" required oninput="calculatePrice()" onchange="calculatePrice()">
                    </div>

                    <div class="form-group">
                        <label>¿Fumas o has fumado en los últimos 5 años?</label>
                        <select id="life-smoking" onchange="console.log('Smoking changed:', this.value); calculatePrice();">
                            <option value="never">Nunca he fumado</option>
                            <option value="quit">Dejé de fumar hace más de 5 años</option>
                            <option value="occasional">Fumador ocasional</option>
                            <option value="regular">Fumador regular</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>Historial médico familiar</label>
                        <select id="life-family-history" onchange="console.log('Family history changed:', this.value); calculatePrice();">
                            <option value="none">Sin antecedentes familiares significativos</option>
                            <option value="minor">Diabetes o hipertensión en familia</option>
                            <option value="moderate">Enfermedad cardíaca en familia</option>
                            <option value="severe">Cáncer o múltiples condiciones en familia</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>Condiciones médicas actuales</label>
                        <div style="display: flex; flex-direction: column; gap: 0.75rem; margin-top: 0.5rem;">
                            <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer; font-weight: normal;">
                                <input type="checkbox" id="life-diabetes" onchange="console.log('Diabetes checked:', this.checked); calculatePrice();" style="width: auto; margin: 0;">
                                <span>Diabetes</span>
                            </label>
                            <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer; font-weight: normal;">
                                <input type="checkbox" id="life-hypertension" onchange="console.log('Hypertension checked:', this.checked); calculatePrice();" style="width: auto; margin: 0;">
                                <span>Hipertensión</span>
                            </label>
                            <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer; font-weight: normal;">
                                <input type="checkbox" id="life-heart" onchange="console.log('Heart checked:', this.checked); calculatePrice();" style="width: auto; margin: 0;">
                                <span>Problemas cardíacos</span>
                            </label>
                            <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer; font-weight: normal;">
                                <input type="checkbox" id="life-mental" onchange="console.log('Mental checked:', this.checked); calculatePrice();" style="width: auto; margin: 0;">
                                <span>Condiciones de salud mental (ansiedad/depresión)</span>
                            </label>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Índice de Masa Corporal (IMC)</label>
                        <select id="life-bmi" onchange="console.log('BMI changed:', this.value); calculatePrice();">
                            <option value="underweight">Bajo peso (IMC < 18.5)</option>
                            <option value="normal" selected>Peso normal (IMC 18.5-24.9)</option>
                            <option value="overweight">Sobrepeso (IMC 25-29.9)</option>
                            <option value="obese1">Obesidad grado I (IMC 30-34.9)</option>
                            <option value="obese2">Obesidad grado II+ (IMC ≥ 35)</option>
                        </select>
                    </div>
                </div>

                <!-- Health Insurance -->
                <div id="salud-params" class="insurance-params" style="display: none;">
                    <div class="form-group">
                        <label>Tipo de cobertura</label>
                        <select id="health-coverage-type" onchange="calculatePrice()">
                            <option value="basic">Básica - Consultas y emergencias</option>
                            <option value="standard">Estándar - Incluye especialistas</option>
                            <option value="premium">Premium - Cobertura completa</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>Edad</label>
                        <input type="number" id="health-age" min="0" max="100" value="35" required oninput="calculatePrice()" onchange="calculatePrice()">
                    </div>

                    <div class="form-group">
                        <label>Número de beneficiarios</label>
                        <input type="number" id="health-beneficiaries" min="1" max="10" value="1" required oninput="calculatePrice()" onchange="calculatePrice()">
                    </div>

                    <div class="form-group">
                        <label>¿Fumas actualmente?</label>
                        <select id="health-smoking" onchange="calculatePrice()">
                            <option value="no">No fumo</option>
                            <option value="occasional">Ocasionalmente</option>
                            <option value="yes">Sí, regularmente</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>Condiciones preexistentes</label>
                        <div style="display: flex; flex-direction: column; gap: 0.75rem; margin-top: 0.5rem;">
                            <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer; font-weight: normal;">
                                <input type="checkbox" id="health-diabetes" onchange="calculatePrice()" style="width: auto; margin: 0;">
                                <span>Diabetes</span>
                            </label>
                            <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer; font-weight: normal;">
                                <input type="checkbox" id="health-hypertension" onchange="calculatePrice()" style="width: auto; margin: 0;">
                                <span>Hipertensión</span>
                            </label>
                            <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer; font-weight: normal;">
                                <input type="checkbox" id="health-asthma" onchange="calculatePrice()" style="width: auto; margin: 0;">
                                <span>Asma</span>
                            </label>
                            <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer; font-weight: normal;">
                                <input type="checkbox" id="health-heart" onchange="calculatePrice()" style="width: auto; margin: 0;">
                                <span>Enfermedad cardíaca</span>
                            </label>
                            <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer; font-weight: normal;">
                                <input type="checkbox" id="health-cancer" onchange="calculatePrice()" style="width: auto; margin: 0;">
                                <span>Cáncer (actual o en remisión)</span>
                            </label>
                            <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer; font-weight: normal;">
                                <input type="checkbox" id="health-mental" onchange="calculatePrice()" style="width: auto; margin: 0;">
                                <span>Tratamiento psiquiátrico/psicológico</span>
                            </label>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>¿Con qué frecuencia necesitas atención médica?</label>
                        <select id="health-frequency" onchange="calculatePrice()">
                            <option value="rarely">Raramente (1-2 veces al año)</option>
                            <option value="occasional">Ocasional (3-6 veces al año)</option>
                            <option value="frequent">Frecuente (mensualmente)</option>
                            <option value="chronic">Muy frecuente (semanalmente)</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>¿Tomas medicamentos de forma regular?</label>
                        <select id="health-medications" onchange="calculatePrice()">
                            <option value="none">No tomo medicamentos</option>
                            <option value="occasional">Ocasionalmente</option>
                            <option value="1-2">1-2 medicamentos regulares</option>
                            <option value="3-5">3-5 medicamentos regulares</option>
                            <option value="6+">6 o más medicamentos</option>
                        </select>
                    </div>
                </div>

                <!-- Device Insurance -->
                <div id="dispositivo-params" class="insurance-params" style="display: none;">
                    <div class="form-group">
                        <label>Tipo de dispositivo</label>
                        <select id="device-type" onchange="updateDeviceBrands()">
                            <option value="">Selecciona un tipo</option>
                            <option value="smartphone">Smartphone</option>
                            <option value="laptop">Laptop</option>
                            <option value="tablet">Tablet</option>
                            <option value="smartwatch">Smartwatch</option>
                            <option value="camera">Cámara</option>
                        </select>
                    </div>

                    <div class="form-group" id="device-brand-container" style="display: none;">
                        <label>Marca</label>
                        <select id="device-brand" onchange="updateDeviceModels()">
                            <option value="">Selecciona una marca</option>
                        </select>
                    </div>

                    <div class="form-group" id="device-model-container" style="display: none;">
                        <label>Modelo</label>
                        <select id="device-model" onchange="calculateDeviceValue()">
                            <option value="">Selecciona un modelo</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>Tipo de cobertura</label>
                        <select id="device-coverage" onchange="calculatePrice()">
                            <option value="basic">Básica - Robo y daño accidental</option>
                            <option value="premium">Premium - Todo riesgo</option>
                        </select>
                    </div>

                    <div class="coverage-chart" id="device-value-display" style="display: none; margin-top: 1rem;">
                        <div class="coverage-item">
                            <div class="label">Valor del dispositivo</div>
                            <div class="value" id="device-calculated-value">$0</div>
                        </div>
                    </div>
                </div>

                <!-- P2P Community Insurance -->
                <div id="p2p-params" class="insurance-params" style="display: none;">
                    <div class="form-group">
                        <label>Tipo de grupo</label>
                        <select id="p2p-group-type" onchange="calculatePrice()">
                            <option value="friends">Amigos y familia (5-10 personas)</option>
                            <option value="neighbors">Vecinos del barrio (10-20 personas)</option>
                            <option value="workers">Compañeros de trabajo (15-30 personas)</option>
                            <option value="cooperative">Cooperativa (30+ personas)</option>
                        </select>
                    </div>

                    <div class="slider-container">
                        <div class="slider-header">
                            <label>Contribución mensual por miembro</label>
                            <span class="slider-value" id="p2p-contribution-value">$20</span>
                        </div>
                        <input type="range" class="custom-slider" id="p2p-contribution-slider" min="5" max="100" value="20" step="5">
                        <div class="slider-labels">
                            <span>$5</span>
                            <span>$100</span>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Miembros del grupo</label>
                        <div id="group-members">
                            <div class="group-member">
                                <input type="text" placeholder="Nombre del miembro" required>
                            </div>
                        </div>
                        <button type="button" class="add-member-btn" onclick="addGroupMember()">+ Agregar miembro</button>
                    </div>

                    <div class="coverage-chart">
                        <h4>Funcionamiento del pool</h4>
                        <div class="coverage-item">
                            <div class="label">Pool mensual estimado</div>
                            <div class="value" id="p2p-pool-value">$200</div>
                        </div>
                        <div class="coverage-item">
                            <div class="label">Cobertura por evento pequeño</div>
                            <div class="value">Hasta $500</div>
                        </div>
                        <div class="coverage-item">
                            <div class="label">Protección catastrófica</div>
                            <div class="value">Incluida</div>
                        </div>
                    </div>
                </div>

                <!-- Remittance Insurance -->
                <div id="remesas-params" class="insurance-params" style="display: none;">
                    <div class="slider-container">
                        <div class="slider-header">
                            <label>Monto promedio de remesa mensual</label>
                            <span class="slider-value" id="remittance-amount-value">$500</span>
                        </div>
                        <input type="range" class="custom-slider" id="remittance-amount-slider" min="100" max="3000" value="500" step="50">
                        <div class="slider-labels">
                            <span>$100</span>
                            <span>$3,000</span>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Frecuencia de envío</label>
                        <select id="remittance-frequency" onchange="calculatePrice()">
                            <option value="monthly">Mensual</option>
                            <option value="biweekly">Quincenal</option>
                            <option value="weekly">Semanal</option>
                            <option value="occasional">Ocasional</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>País de destino</label>
                        <select id="remittance-destination" onchange="calculatePrice()">
                            <option value="mexico">México</option>
                            <option value="guatemala">Guatemala</option>
                            <option value="elsalvador">El Salvador</option>
                            <option value="honduras">Honduras</option>
                            <option value="colombia">Colombia</option>
                            <option value="peru">Perú</option>
                        </select>
                    </div>

                    <div class="coverage-chart">
                        <h4>Tu protección incluye</h4>
                        <div class="coverage-item">
                            <div class="label">Si algo te pasa</div>
                            <div class="value">6 meses de remesas garantizadas</div>
                        </div>
                        <div class="coverage-item">
                            <div class="label">Activación automática</div>
                            <div class="value">Sin papeleos para tu familia</div>
                        </div>
                    </div>
                </div>

                <!-- Entrepreneur Insurance -->
                <div id="emprendedor-params" class="insurance-params" style="display: none;">
                    <div class="form-group">
                        <label>Tipo de negocio</label>
                        <select id="business-type" onchange="calculatePrice()">
                            <option value="food">Comida (restaurant, food truck)</option>
                            <option value="retail">Retail (tienda, kiosco)</option>
                            <option value="services">Servicios (peluquería, taller)</option>
                            <option value="digital">Digital (e-commerce, apps)</option>
                            <option value="manufacturing">Manufactura pequeña</option>
                        </select>
                    </div>

                    <div class="slider-container">
                        <div class="slider-header">
                            <label>Ingresos mensuales promedio</label>
                            <span class="slider-value" id="business-revenue-value">$5,000</span>
                        </div>
                        <input type="range" class="custom-slider" id="business-revenue-slider" min="1000" max="50000" value="5000" step="1000">
                        <div class="slider-labels">
                            <span>$1,000</span>
                            <span>$50,000</span>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Número de empleados</label>
                        <input type="number" id="business-employees" min="0" max="50" value="2" required onchange="calculatePrice()">
                    </div>

                    <div class="form-group">
                        <label>Coberturas necesarias</label>
                        <div style="display: flex; flex-direction: column; gap: 0.75rem; margin-top: 0.5rem;">
                            <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer; font-weight: normal;">
                                <input type="checkbox" id="liability-coverage" checked onchange="calculatePrice()" style="width: auto; margin: 0;">
                                <span>Responsabilidad civil</span>
                            </label>
                            <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer; font-weight: normal;">
                                <input type="checkbox" id="equipment-coverage" checked onchange="calculatePrice()" style="width: auto; margin: 0;">
                                <span>Equipos y mercancía</span>
                            </label>
                            <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer; font-weight: normal;">
                                <input type="checkbox" id="income-coverage" onchange="calculatePrice()" style="width: auto; margin: 0;">
                                <span>Pérdida de ingresos</span>
                            </label>
                            <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer; font-weight: normal;">
                                <input type="checkbox" id="cyber-coverage" onchange="calculatePrice()" style="width: auto; margin: 0;">
                                <span>Ciber riesgos</span>
                            </label>
                        </div>
                    </div>
                </div>

                <!-- Coverage Visualization -->
                <div class="coverage-chart">
                    <h4 style="margin-bottom: 1rem;">Tu cobertura incluye:</h4>
                    <div class="coverage-item">
                        <div class="label">
                            <i class="fas fa-check"></i>
                            <span>Pago automático en 7 días</span>
                        </div>
                        <div class="value">Incluido</div>
                    </div>
                    <div class="coverage-item">
                        <div class="label">
                            <i class="fas fa-check"></i>
                            <span>Sin deducible</span>
                        </div>
                        <div class="value">Incluido</div>
                    </div>
                    <div class="coverage-item">
                        <div class="label">
                            <i class="fas fa-check"></i>
                            <span>Gestión 100% digital</span>
                        </div>
                        <div class="value">Incluido</div>
                    </div>
                </div>

                <div class="button-group">
                    <button class="btn btn-secondary" onclick="previousStep()">Atrás</button>
                    <button class="btn btn-primary" onclick="nextStep()">Continuar</button>
                </div>
            </div>

            <!-- Step 4: Review & Confirm -->
            <div class="form-section" id="step4">
                <div class="section-header">
                    <h2>Revisa y confirma</h2>
                    <p>Verifica que toda la información sea correcta</p>
                </div>

                <div class="success-message" id="success-message">
                    <h3>¡Felicidades! Tu cotización está lista</h3>
                    <p>Un asesor se contactará contigo en los próximos minutos</p>
                </div>

                <div class="coverage-chart">
                    <h4 style="margin-bottom: 1rem;">Resumen de tu seguro</h4>
                    <div id="final-summary">
                        <!-- Summary will be populated by JavaScript -->
                    </div>
                </div>

                <div class="form-group">
                    <label>
                        <input type="checkbox" id="terms" required>
                        Acepto los términos y condiciones y la política de privacidad
                    </label>
                </div>

                <div class="button-group">
                    <button class="btn btn-secondary" onclick="previousStep()">Atrás</button>
                    <button class="btn btn-success pulse" onclick="submitQuote()">Contratar Ahora</button>
                </div>

                <div class="loading" id="loading">
                    <div class="spinner"></div>
                    <p style="margin-top: 1rem;">Procesando tu solicitud...</p>
                </div>
            </div>
        </div>

        <!-- Summary Sidebar -->
        <div class="summary-sidebar">
            <div class="summary-card">
                <div class="summary-header">
                    <h3>Tu cotización</h3>
                    <div class="price-display" id="price-display">$0</div>
                    <div class="price-period">por mes</div>
                </div>

                <div class="summary-details" id="summary-details">
                    <div class="detail-item">
                        <span class="label">Tipo de seguro:</span>
                        <span class="value" id="summary-type">-</span>
                    </div>
                    <div class="detail-item">
                        <span class="label">Cobertura:</span>
                        <span class="value" id="summary-coverage">-</span>
                    </div>
                    <div class="detail-item">
                        <span class="label">Inicio de vigencia:</span>
                        <span class="value">Inmediato</span>
                    </div>
                </div>

                <div class="features-list">
                    <div class="feature-item">
                        <span class="check"><i class="fas fa-check"></i></span>
                        <span>Sin letra chica</span>
                    </div>
                    <div class="feature-item">
                        <span class="check"><i class="fas fa-check"></i></span>
                        <span>Cancela cuando quieras</span>
                    </div>
                    <div class="feature-item">
                        <span class="check"><i class="fas fa-check"></i></span>
                        <span>Atención 24/7 por WhatsApp</span>
                    </div>
                    <div class="feature-item">
                        <span class="check"><i class="fas fa-check"></i></span>
                        <span>Pagos con cualquier medio</span>
                    </div>
                </div>

                <div id="price-breakdown" style="margin-top: 1.5rem; padding: 1rem; background: var(--light-bg); border-radius: 10px; font-size: 0.875rem; display: none;">
                    <h4 style="margin-bottom: 0.5rem; font-size: 1rem;">Factores de precio:</h4>
                    <div id="breakdown-details"></div>
                </div>

                <div style="margin-top: 1.5rem; text-align: center;">
                    <small style="color: var(--text-light);">
                        <span class="tooltip">
                            <i class="fas fa-lock"></i> Tus datos están seguros
                            <span class="tooltiptext">Utilizamos encriptación de grado bancario para proteger tu información</span>
                        </span>
                    </small>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global state
        let currentStep = 1;
        let selectedInsurance = null;
        let deviceValue = 0; // Store calculated device value
        let quoteData = {
            type: '',
            name: '',
            email: '',
            phone: '',
            location: '',
            parameters: {},
            price: 0
        };

        // Check for insurance type in URL params (from home page)
        window.addEventListener('load', function() {
            const urlParams = new URLSearchParams(window.location.search);
            const insuranceType = urlParams.get('type');
            
            if (insuranceType) {
                // Find and click the corresponding insurance option
                const option = document.querySelector(`[data-type="${insuranceType}"]`);
                if (option) {
                    option.click();
                }
            }
            
            setupSliders();
            
            // Ensure all change handlers are properly attached
            attachAllEventHandlers();
        });
        
        // Attach all event handlers for medical questions
        function attachAllEventHandlers() {
            // Life insurance handlers
            const lifeElements = [
                'life-smoking', 'life-family-history', 'life-bmi',
                'life-diabetes', 'life-hypertension', 'life-heart', 'life-mental'
            ];
            
            lifeElements.forEach(id => {
                const element = document.getElementById(id);
                if (element) {
                    element.removeEventListener('change', calculatePrice); // Remove any existing
                    element.addEventListener('change', calculatePrice);
                }
            });
            
            // Health insurance handlers
            const healthElements = [
                'health-smoking', 'health-frequency', 'health-medications',
                'health-diabetes', 'health-hypertension', 'health-asthma',
                'health-heart', 'health-cancer', 'health-mental'
            ];
            
            healthElements.forEach(id => {
                const element = document.getElementById(id);
                if (element) {
                    element.removeEventListener('change', calculatePrice); // Remove any existing
                    element.addEventListener('change', calculatePrice);
                }
            });

            // Device insurance handlers
            const deviceElements = [
                'device-type', 'device-brand', 'device-model', 'device-coverage'
            ];
            
            deviceElements.forEach(id => {
                const element = document.getElementById(id);
                if (element) {
                    element.removeEventListener('change', calculatePrice); // Remove any existing
                    if (id === 'device-type') {
                        element.addEventListener('change', updateDeviceBrands);
                    } else if (id === 'device-brand') {
                        element.addEventListener('change', updateDeviceModels);
                    } else if (id === 'device-model') {
                        element.addEventListener('change', calculateDeviceValue);
                    } else if (id === 'device-coverage') {
                        element.addEventListener('change', calculatePrice);
                    }
                }
            });
        }

        // Insurance type selection
        document.querySelectorAll('.insurance-option').forEach(option => {
            option.addEventListener('click', function() {
                // Special handling for agricultural insurance
                if (this.dataset.type === 'agricola') {
                    window.location.href = 'agri-selection.html';
                    return;
                }
                
                document.querySelectorAll('.insurance-option').forEach(opt => opt.classList.remove('selected'));
                this.classList.add('selected');
                selectedInsurance = this.dataset.type;
                quoteData.type = selectedInsurance;
                document.getElementById('step1-next').disabled = false;
                updateSummary();
            });
        });

        // Slider event listeners
        function setupSliders() {
            const sliders = {
                'rainfall-slider': {
                    valueId: 'rainfall-value',
                    format: (val) => `${val}mm`
                },
                'coverage-slider': {
                    valueId: 'coverage-value',
                    format: (val) => `$${parseInt(val).toLocaleString()}`
                },
                'km-slider': {
                    valueId: 'km-value',
                    format: (val) => `${parseInt(val).toLocaleString()} km`
                },
                'life-coverage-slider': {
                    valueId: 'life-coverage-value',
                    format: (val) => `$${parseInt(val).toLocaleString()}`
                },
                'p2p-contribution-slider': {
                    valueId: 'p2p-contribution-value',
                    format: (val) => `$${val}`
                },
                'remittance-amount-slider': {
                    valueId: 'remittance-amount-value',
                    format: (val) => `$${parseInt(val).toLocaleString()}`
                },
                'business-revenue-slider': {
                    valueId: 'business-revenue-value',
                    format: (val) => `$${parseInt(val).toLocaleString()}`
                }
            };

            Object.keys(sliders).forEach(sliderId => {
                const slider = document.getElementById(sliderId);
                if (slider) {
                    slider.addEventListener('input', function() {
                        const config = sliders[sliderId];
                        const valueElement = document.getElementById(config.valueId);
                        if (valueElement) {
                            valueElement.textContent = config.format(this.value);
                        }
                        calculatePrice();
                    });
                }
            });
        }

        // Update device brands based on type
        function updateDeviceBrands() {
            const deviceType = document.getElementById('device-type').value;
            const brandContainer = document.getElementById('device-brand-container');
            const modelContainer = document.getElementById('device-model-container');
            const brandSelect = document.getElementById('device-brand');
            const valueDisplay = document.getElementById('device-value-display');
            
            const brands = {
                'smartphone': ['Apple', 'Samsung', 'Xiaomi', 'Motorola', 'Google', 'OnePlus'],
                'laptop': ['Apple', 'Dell', 'HP', 'Lenovo', 'ASUS', 'Microsoft'],
                'tablet': ['Apple', 'Samsung', 'Microsoft', 'Amazon', 'Lenovo'],
                'smartwatch': ['Apple', 'Samsung', 'Garmin', 'Fitbit', 'Amazfit'],
                'camera': ['Canon', 'Nikon', 'Sony', 'Fujifilm', 'Panasonic']
            };
            
            if (deviceType && brands[deviceType]) {
                brandContainer.style.display = 'block';
                modelContainer.style.display = 'block';
                valueDisplay.style.display = 'block';
                
                // Clear and populate brand options
                brandSelect.innerHTML = '<option value="">Selecciona una marca</option>';
                brands[deviceType].forEach(brand => {
                    const option = document.createElement('option');
                    option.value = brand.toLowerCase();
                    option.textContent = brand;
                    brandSelect.appendChild(option);
                });
                
                updateDeviceModels();
            } else {
                brandContainer.style.display = 'none';
                modelContainer.style.display = 'none';
                valueDisplay.style.display = 'none';
                deviceValue = 0;
            }
            
            calculatePrice();
        }

        // Update device models based on brand
        function updateDeviceModels() {
            const deviceType = document.getElementById('device-type').value;
            const deviceBrand = document.getElementById('device-brand').value;
            const modelSelect = document.getElementById('device-model');
            
            // Device models with realistic prices
            const deviceModels = {
                'smartphone': {
                    'apple': [
                        {name: 'iPhone 15 Pro Max', value: 1200},
                        {name: 'iPhone 15 Pro', value: 1000},
                        {name: 'iPhone 15', value: 800},
                        {name: 'iPhone 14', value: 700},
                        {name: 'iPhone 13', value: 600}
                    ],
                    'samsung': [
                        {name: 'Galaxy S24 Ultra', value: 1200},
                        {name: 'Galaxy S24+', value: 1000},
                        {name: 'Galaxy S24', value: 800},
                        {name: 'Galaxy A54', value: 450},
                        {name: 'Galaxy A34', value: 350}
                    ],
                    'xiaomi': [
                        {name: 'Xiaomi 14 Pro', value: 700},
                        {name: 'Xiaomi 14', value: 500},
                        {name: 'Redmi Note 13 Pro', value: 350},
                        {name: 'Redmi Note 13', value: 250},
                        {name: 'Poco X6', value: 300}
                    ],
                    'motorola': [
                        {name: 'Edge 40 Pro', value: 800},
                        {name: 'Edge 40', value: 600},
                        {name: 'Moto G84', value: 300},
                        {name: 'Moto G54', value: 250}
                    ],
                    'google': [
                        {name: 'Pixel 8 Pro', value: 1000},
                        {name: 'Pixel 8', value: 700},
                        {name: 'Pixel 7a', value: 500}
                    ],
                    'oneplus': [
                        {name: 'OnePlus 12', value: 800},
                        {name: 'OnePlus 11', value: 700},
                        {name: 'OnePlus Nord 3', value: 400}
                    ]
                },
                'laptop': {
                    'apple': [
                        {name: 'MacBook Pro 16" M3', value: 2500},
                        {name: 'MacBook Pro 14" M3', value: 2000},
                        {name: 'MacBook Air M3', value: 1500},
                        {name: 'MacBook Air M2', value: 1200}
                    ],
                    'dell': [
                        {name: 'XPS 15', value: 1800},
                        {name: 'XPS 13', value: 1400},
                        {name: 'Inspiron 15', value: 800},
                        {name: 'Latitude 7440', value: 1200}
                    ],
                    'hp': [
                        {name: 'Spectre x360', value: 1500},
                        {name: 'Envy 15', value: 1100},
                        {name: 'Pavilion 15', value: 700}
                    ],
                    'lenovo': [
                        {name: 'ThinkPad X1 Carbon', value: 1600},
                        {name: 'ThinkPad T14', value: 1200},
                        {name: 'IdeaPad 5', value: 700},
                        {name: 'Legion 5', value: 1100}
                    ],
                    'asus': [
                        {name: 'ROG Zephyrus G14', value: 1600},
                        {name: 'ZenBook 14', value: 1000},
                        {name: 'VivoBook 15', value: 600}
                    ],
                    'microsoft': [
                        {name: 'Surface Laptop 5', value: 1300},
                        {name: 'Surface Pro 9', value: 1100}
                    ]
                },
                'tablet': {
                    'apple': [
                        {name: 'iPad Pro 12.9"', value: 1100},
                        {name: 'iPad Pro 11"', value: 800},
                        {name: 'iPad Air', value: 600},
                        {name: 'iPad', value: 450},
                        {name: 'iPad Mini', value: 500}
                    ],
                    'samsung': [
                        {name: 'Galaxy Tab S9 Ultra', value: 1200},
                        {name: 'Galaxy Tab S9+', value: 1000},
                        {name: 'Galaxy Tab S9', value: 800},
                        {name: 'Galaxy Tab A9+', value: 400},
                        {name: 'Galaxy Tab A9', value: 300}
                    ],
                    'microsoft': [
                        {name: 'Surface Pro 9', value: 1000},
                        {name: 'Surface Go 3', value: 400}
                    ],
                    'amazon': [
                        {name: 'Fire HD 10', value: 150},
                        {name: 'Fire HD 8', value: 100}
                    ],
                    'lenovo': [
                        {name: 'Tab P11 Pro', value: 500},
                        {name: 'Tab M10', value: 200}
                    ]
                },
                'smartwatch': {
                    'apple': [
                        {name: 'Apple Watch Ultra 2', value: 800},
                        {name: 'Apple Watch Series 9', value: 400},
                        {name: 'Apple Watch SE', value: 250}
                    ],
                    'samsung': [
                        {name: 'Galaxy Watch 6 Classic', value: 400},
                        {name: 'Galaxy Watch 6', value: 300},
                        {name: 'Galaxy Watch 5', value: 250}
                    ],
                    'garmin': [
                        {name: 'Fenix 7', value: 700},
                        {name: 'Venu 3', value: 450},
                        {name: 'Forerunner 265', value: 400}
                    ],
                    'fitbit': [
                        {name: 'Sense 2', value: 300},
                        {name: 'Versa 4', value: 230},
                        {name: 'Charge 6', value: 160}
                    ],
                    'amazfit': [
                        {name: 'GTR 4', value: 200},
                        {name: 'GTS 4', value: 200},
                        {name: 'Bip 3', value: 70}
                    ]
                },
                'camera': {
                    'canon': [
                        {name: 'EOS R5', value: 3900},
                        {name: 'EOS R6 Mark II', value: 2500},
                        {name: 'EOS R10', value: 980}
                    ],
                    'nikon': [
                        {name: 'Z9', value: 5500},
                        {name: 'Z6 III', value: 2500},
                        {name: 'Z50', value: 860}
                    ],
                    'sony': [
                        {name: 'A7R V', value: 3900},
                        {name: 'A7 IV', value: 2500},
                        {name: 'A6700', value: 1400}
                    ],
                    'fujifilm': [
                        {name: 'X-T5', value: 1700},
                        {name: 'X-S20', value: 1300},
                        {name: 'X-T30 II', value: 900}
                    ],
                    'panasonic': [
                        {name: 'Lumix S5 II', value: 2000},
                        {name: 'Lumix GH6', value: 2200},
                        {name: 'Lumix G9 II', value: 1900}
                    ]
                }
            };
            
            // Clear model options
            modelSelect.innerHTML = '<option value="">Selecciona un modelo</option>';
            
            if (deviceType && deviceBrand && deviceModels[deviceType] && deviceModels[deviceType][deviceBrand]) {
                deviceModels[deviceType][deviceBrand].forEach(model => {
                    const option = document.createElement('option');
                    option.value = model.value;
                    option.textContent = model.name;
                    modelSelect.appendChild(option);
                });
            }
            
            calculateDeviceValue();
        }

        // Calculate device value based on selection
        function calculateDeviceValue() {
            const modelSelect = document.getElementById('device-model');
            const valueDisplay = document.getElementById('device-calculated-value');
            
            if (modelSelect && modelSelect.value) {
                deviceValue = parseInt(modelSelect.value);
                if (valueDisplay) {
                    valueDisplay.textContent = `$${deviceValue.toLocaleString()}`;
                }
            } else {
                deviceValue = 0;
                if (valueDisplay) {
                    valueDisplay.textContent = '$0';
                }
            }
            
            calculatePrice();
        }

        // Calculate price based on parameters
        function calculatePrice() {
            let basePrice = 0;
            
            switch(selectedInsurance) {
                case 'agricola':
                    const rainfall = parseInt(document.getElementById('rainfall-slider')?.value || 250);
                    const coverage = parseInt(document.getElementById('coverage-slider')?.value || 5000);
                    const hectares = parseInt(document.getElementById('hectares')?.value || 10);
                    
                    const riskFactor = (500 - rainfall) / 500;
                    basePrice = coverage * hectares * 0.002 * (1 + riskFactor);
                    break;
                    
                case 'vehiculo':
                    const km = parseInt(document.getElementById('km-slider')?.value || 1000);
                    const use = document.getElementById('vehicle-use')?.value || 'personal';
                    
                    const ratePerKm = 0.025;
                    basePrice = km * ratePerKm;
                    
                    const useMultipliers = {
                        'personal': 1,
                        'uber': 1.8,
                        'delivery': 2.2,
                        'comercial': 1.5
                    };
                    basePrice *= useMultipliers[use] || 1;
                    break;
                    
                case 'vida':
                    const lifeCoverage = parseInt(document.getElementById('life-coverage-slider')?.value || 50000);
                    const age = parseInt(document.getElementById('life-age')?.value || 35);
                    
                    const ageMultiplier = Math.pow(1.08, Math.max(0, age - 25));
                    basePrice = (lifeCoverage / 1000) * 0.5 * ageMultiplier;
                    break;
                    
                case 'salud':
                    const healthType = document.getElementById('health-coverage-type')?.value || 'standard';
                    const beneficiaries = parseInt(document.getElementById('health-beneficiaries')?.value || 1);
                    
                    const healthPrices = {
                        'basic': 30,
                        'standard': 60,
                        'premium': 120
                    };
                    basePrice = healthPrices[healthType] * (1 + (beneficiaries - 1) * 0.6);
                    break;
                    
                case 'dispositivo':
                    const deviceCoverage = document.getElementById('device-coverage');
                    const deviceType = document.getElementById('device-type');
                    
                    if (deviceValue > 0 && deviceType && deviceType.value && deviceCoverage) {
                        const coverage = deviceCoverage.value || 'basic';
                        const type = deviceType.value;
                        
                        // Base rate as percentage of device value
                        let baseRate = coverage === 'basic' ? 0.08 : 0.12; // 8% or 12% annually
                        
                        // Device type risk multipliers
                        const typeMultipliers = {
                            'smartphone': 1.2,
                            'laptop': 1,
                            'tablet': 1.1,
                            'smartwatch': 1.3,
                            'camera': 0.9
                        };
                        
                        basePrice = (deviceValue * baseRate * (typeMultipliers[type] || 1)) / 12; // Monthly price
                    } else {
                        basePrice = 15;
                    }
                    break;
                    
                case 'p2p':
                    const contribution = parseInt(document.getElementById('p2p-contribution-slider')?.value || 20);
                    const groupType = document.getElementById('p2p-group-type')?.value || 'friends';
                    const members = document.querySelectorAll('#group-members .group-member').length;
                    
                    // Admin fee based on group size
                    const adminFees = {
                        'friends': 0.15,
                        'neighbors': 0.12,
                        'workers': 0.10,
                        'cooperative': 0.08
                    };
                    
                    basePrice = contribution * (1 + (adminFees[groupType] || 0.15));
                    
                    // Update pool value
                    const poolValue = contribution * members;
                    const poolElement = document.getElementById('p2p-pool-value');
                    if (poolElement) {
                        poolElement.textContent = `$${poolValue}`;
                    }
                    break;
                    
                case 'remesas':
                    const remittanceAmount = parseInt(document.getElementById('remittance-amount-slider')?.value || 500);
                    const frequency = document.getElementById('remittance-frequency')?.value || 'monthly';
                    
                    // Base rate: 1.5% of monthly remittance amount
                    let monthlyAmount = remittanceAmount;
                    if (frequency === 'biweekly') monthlyAmount *= 2;
                    else if (frequency === 'weekly') monthlyAmount *= 4;
                    else if (frequency === 'occasional') monthlyAmount *= 0.5;
                    
                    basePrice = monthlyAmount * 0.015; // 1.5% of protected amount
                    break;
                    
                case 'emprendedor':
                    const revenue = parseInt(document.getElementById('business-revenue-slider')?.value || 5000);
                    const employees = parseInt(document.getElementById('business-employees')?.value || 2);
                    const businessType = document.getElementById('business-type')?.value || 'retail';
                    
                    // Base rate by business type
                    const businessRates = {
                        'food': 0.025,
                        'retail': 0.02,
                        'services': 0.018,
                        'digital': 0.015,
                        'manufacturing': 0.03
                    };
                    
                    basePrice = revenue * (businessRates[businessType] || 0.02);
                    
                    // Employee adjustment
                    basePrice += employees * 5;
                    
                    // Coverage adjustments
                    if (document.getElementById('liability-coverage')?.checked) basePrice *= 1.2;
                    if (document.getElementById('equipment-coverage')?.checked) basePrice *= 1.15;
                    if (document.getElementById('income-coverage')?.checked) basePrice *= 1.25;
                    if (document.getElementById('cyber-coverage')?.checked) basePrice *= 1.1;
                    break;
                    
                default:
                    basePrice = 50;
            }
            
            quoteData.price = Math.round(basePrice);
            updatePriceDisplay();
            updateSummaryCoverage();
        }

        // Update price display
        function updatePriceDisplay() {
            const priceElement = document.getElementById('price-display');
            const oldPrice = priceElement.textContent;
            const newPrice = `$${quoteData.price.toLocaleString()}`;
            
            if (oldPrice !== newPrice) {
                // Add animation when price changes
                priceElement.style.transform = 'scale(1.1)';
                priceElement.style.transition = 'transform 0.3s ease';
                
                setTimeout(() => {
                    priceElement.textContent = newPrice;
                    priceElement.style.transform = 'scale(1)';
                }, 150);
            } else {
                priceElement.textContent = newPrice;
            }
        }

        // Update summary
        function updateSummary() {
            const typeMap = {
                'agricola': 'Seguro Agrícola',
                'vehiculo': 'Seguro Vehicular',
                'vida': 'Seguro de Vida',
                'salud': 'Seguro de Salud',
                'dispositivo': 'Seguro de Dispositivo',
                'p2p': 'Seguro P2P Comunitario',
                'remesas': 'Seguro de Remesas',
                'emprendedor': 'Seguro para Emprendedores'
            };
            
            document.getElementById('summary-type').textContent = typeMap[selectedInsurance] || '-';
            
            if (selectedInsurance) {
                calculatePrice();
            }
        }

        // Update summary coverage details
        function updateSummaryCoverage() {
            let coverageText = '-';
            let riskFactors = [];
            
            switch(selectedInsurance) {
                case 'agricola':
                    const hectares = document.getElementById('hectares')?.value || 10;
                    coverageText = `${hectares} hectáreas`;
                    break;
                case 'vehiculo':
                    const km = document.getElementById('km-slider')?.value || 1000;
                    coverageText = `${parseInt(km).toLocaleString()} km/mes`;
                    break;
                case 'vida':
                    const lifeCoverage = document.getElementById('life-coverage-slider')?.value || 50000;
                    coverageText = `$${parseInt(lifeCoverage).toLocaleString()}`;
                    
                    // Show risk factors for life insurance
                    const smoking = document.getElementById('life-smoking')?.value;
                    if (smoking && smoking !== 'never') riskFactors.push('Fumador');
                    if (document.getElementById('life-diabetes')?.checked) riskFactors.push('Diabetes');
                    if (document.getElementById('life-hypertension')?.checked) riskFactors.push('Hipertensión');
                    if (document.getElementById('life-heart')?.checked) riskFactors.push('Cardíaco');
                    break;
                case 'salud':
                    const healthType = document.getElementById('health-coverage-type')?.value;
                    const beneficiaries = document.getElementById('health-beneficiaries')?.value || 1;
                    const typeText = {'basic': 'Básica', 'standard': 'Estándar', 'premium': 'Premium'};
                    coverageText = `${typeText[healthType] || 'Estándar'} - ${beneficiaries} persona(s)`;
                    
                    // Show risk factors for health insurance
                    const healthSmoking = document.getElementById('health-smoking')?.value;
                    if (healthSmoking && healthSmoking !== 'no') riskFactors.push('Fumador');
                    if (document.getElementById('health-diabetes')?.checked) riskFactors.push('Diabetes');
                    if (document.getElementById('health-hypertension')?.checked) riskFactors.push('Hipertensión');
                    if (document.getElementById('health-cancer')?.checked) riskFactors.push('Cáncer');
                    break;
                case 'dispositivo':
                    if (deviceValue > 0) {
                        coverageText = `Valor: $${deviceValue.toLocaleString()}`;
                    }
                    break;
                case 'p2p':
                    const members = document.querySelectorAll('#group-members .group-member').length;
                    coverageText = `Grupo de ${members} miembros`;
                    break;
                case 'remesas':
                    const amount = document.getElementById('remittance-amount-slider')?.value || 500;
                    coverageText = `$${parseInt(amount).toLocaleString()}/mes protegidos`;
                    break;
                case 'emprendedor':
                    const businessType = document.getElementById('business-type')?.value;
                    const typeNames = {
                        'food': 'Comida',
                        'retail': 'Retail',
                        'services': 'Servicios',
                        'digital': 'Digital',
                        'manufacturing': 'Manufactura'
                    };
                    coverageText = typeNames[businessType] || 'Negocio';
                    break;
                default:
                    coverageText = 'Completa';
            }
            
            document.getElementById('summary-coverage').textContent = coverageText;
            
            // Update risk factors display if any exist
            const summaryDetails = document.getElementById('summary-details');
            const existingRiskElement = document.getElementById('risk-factors-display');
            
            if (riskFactors.length > 0) {
                const riskHTML = `
                    <div class="detail-item" id="risk-factors-display">
                        <span class="label">Factores de riesgo:</span>
                        <span class="value" style="color: var(--error-color); font-size: 0.8rem;">${riskFactors.join(', ')}</span>
                    </div>
                `;
                
                if (existingRiskElement) {
                    existingRiskElement.outerHTML = riskHTML;
                } else {
                    summaryDetails.insertAdjacentHTML('beforeend', riskHTML);
                }
            } else if (existingRiskElement) {
                existingRiskElement.remove();
            }
        }

        // Add group member for P2P insurance
        function addGroupMember() {
            const container = document.getElementById('group-members');
            const memberDiv = document.createElement('div');
            memberDiv.className = 'group-member';
            memberDiv.innerHTML = `
                <input type="text" placeholder="Nombre del miembro" required>
                <button type="button" onclick="removeGroupMember(this)">×</button>
            `;
            container.appendChild(memberDiv);
            calculatePrice();
        }

        // Remove group member
        function removeGroupMember(button) {
            const members = document.querySelectorAll('#group-members .group-member');
            if (members.length > 1) {
                button.parentElement.remove();
                calculatePrice();
            }
        }

        // Navigation functions
        function nextStep() {
            if (currentStep === 2) {
                // Validate form
                const form = document.getElementById('basic-info-form');
                if (!form.checkValidity()) {
                    form.reportValidity();
                    return;
                }
                
                // Save form data
                quoteData.name = document.getElementById('name').value;
                quoteData.email = document.getElementById('email').value;
                quoteData.phone = document.getElementById('phone').value;
                quoteData.location = document.getElementById('location').value;
            }
            
            if (currentStep < 4) {
                document.getElementById(`step${currentStep}`).classList.remove('active');
                currentStep++;
                document.getElementById(`step${currentStep}`).classList.add('active');
                updateProgressBar();
                
                // Show appropriate parameter controls
                if (currentStep === 3) {
                    document.querySelectorAll('.insurance-params').forEach(param => {
                        param.style.display = 'none';
                    });
                    const selectedParams = document.getElementById(`${selectedInsurance}-params`);
                    if (selectedParams) {
                        selectedParams.style.display = 'block';
                    }
                    setupSliders(); // Re-setup sliders for new params
                    attachAllEventHandlers(); // Attach all event handlers
                    // Small delay to ensure DOM is ready
                    setTimeout(() => {
                        calculatePrice();
                    }, 100);
                }
                
                // Prepare final summary
                if (currentStep === 4) {
                    prepareFinalSummary();
                }
            }
        }

        function previousStep() {
            if (currentStep > 1) {
                document.getElementById(`step${currentStep}`).classList.remove('active');
                currentStep--;
                document.getElementById(`step${currentStep}`).classList.add('active');
                updateProgressBar();
            }
        }

        function updateProgressBar() {
            document.querySelectorAll('.progress-step').forEach((step, index) => {
                if (index < currentStep - 1) {
                    step.classList.add('completed');
                    step.classList.remove('active');
                } else if (index === currentStep - 1) {
                    step.classList.add('active');
                    step.classList.remove('completed');
                } else {
                    step.classList.remove('active', 'completed');
                }
            });
        }

        // Prepare final summary
        function prepareFinalSummary() {
            const summaryHtml = `
                <div class="coverage-item">
                    <div class="label">Tipo de seguro</div>
                    <div class="value">${document.getElementById('summary-type').textContent}</div>
                </div>
                <div class="coverage-item">
                    <div class="label">Titular</div>
                    <div class="value">${quoteData.name}</div>
                </div>
                <div class="coverage-item">
                    <div class="label">Ubicación</div>
                    <div class="value">${quoteData.location}</div>
                </div>
                <div class="coverage-item">
                    <div class="label">Prima mensual</div>
                    <div class="value" style="font-size: 1.25rem;">$${quoteData.price.toLocaleString()}</div>
                </div>
            `;
            document.getElementById('final-summary').innerHTML = summaryHtml;
        }

        // Submit quote
        function submitQuote() {
            const terms = document.getElementById('terms');
            if (!terms.checked) {
                alert('Por favor acepta los términos y condiciones');
                return;
            }
            
            document.getElementById('loading').classList.add('active');
            
            // Simulate API call
            setTimeout(() => {
                document.getElementById('loading').classList.remove('active');
                document.getElementById('success-message').classList.add('active');
                
                // Disable submit button
                const submitBtn = document.querySelector('.btn-success');
                submitBtn.textContent = '✓ Cotización Enviada';
                submitBtn.disabled = true;
                submitBtn.classList.remove('pulse');
                
                // Simulate redirect after success
                setTimeout(() => {
                    alert('¡Gracias! Te redirigiremos a tu panel de cliente...');
                }, 3000);
            }, 2000);
        }

        // Add smooth scroll behavior
        document.querySelectorAll('.progress-step').forEach(step => {
            step.addEventListener('click', function() {
                const stepNumber = parseInt(this.dataset.step);
                if (stepNumber < currentStep || (stepNumber === currentStep + 1 && currentStep === 1 && selectedInsurance)) {
                    document.getElementById(`step${currentStep}`).classList.remove('active');
                    currentStep = stepNumber;
                    document.getElementById(`step${currentStep}`).classList.add('active');
                    updateProgressBar();
                }
            });
        });

        // Initialize
        updateProgressBar();
    </script>
</body>
</html>